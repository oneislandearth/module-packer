#!/usr/bin/env node

!function(e,o){if("object"==typeof exports&&"object"==typeof module)module.exports=o();else if("function"==typeof define&&define.amd)define([],o);else{var r=o();for(var s in r)("object"==typeof exports?exports:e)[s]=r[s]}}(global,(function(){return(()=>{"use strict";var e={105:(e,o,r)=>{r.r(o);var s=r(617);const a=require("child_process");var c=r.n(a);const n=(e,...o)=>c().spawn(e,o,{stdio:"inherit"}).on("error",(e=>console.log(e))),[,,,...t]=process.argv,i=(0,s.executablePath)("webpack"),l=(0,s.resourcePath)("webpack/config.js"),p=e=>{e||(e=s.workspaceDirectory.replace(/(?:\/.*\/)(.*)(?:\/*)/gm,((e,o)=>o)));const{version:o}=(0,s.readJSON)((0,s.packagePath)("package.json"));let r=(0,s.readFile)((0,s.resourcePath)("npm/package.json"));r=r.replace(/(\$MODULE)/gm,e),r=r.replace(/(\$VERSION)/gm,o),(0,s.writeFile)((0,s.workspacePath)("package.json"),r)},[,,,u,...d]=process.argv;process.argv.length<3&&(console.log(),console.log("[0m[35m[1m@oneisland/module-packer[0m\n"),console.log("[35m    init [2m[name][0m"),console.log("[2m    (setup a new library or module)[0m\n"),console.log("[35m    build [2m[webpack-cli-flags][0m"),console.log("[2m    (package up a library or module using webpack)[0m\n"),console.log("[35m    watch [2m[webpack-cli-flags][0m"),console.log("[2m    (package up and watch for library or module changes using webpack -w)[0m\n"),console.log("[35m    serve [2m[webpack-cli-flags][0m"),console.log("[2m    (package up and serve a library or module using webpack serve)[0m\n"),console.log(),process.exit(0));const[,,m,...g]=process.argv;({build:()=>n(i,"build","-c",l,...t),serve:()=>n(i,"serve","-c",l,...t),watch:()=>n(i,"build","-c",l,"--watch",...t),postinstall:()=>{s.isPackage||((0,s.copyResource)("travis/.travis.yml",".travis.yml"),(0,s.copyResource)("git/git-ignore",".gitignore"),(0,s.copyResource)("git/pre-commit",".git/hooks/pre-commit"),(0,s.copyResource)("npm/.npmignore",".npmignore"),(0,s.workspacePathExists)("package.json")?(()=>{const e=(0,s.readJSON)((0,s.workspacePath)("package.json"));e.main||(e.main="lib/bundle.js"),e.scripts||(e.scripts={}),e.scripts.prepublish||(e.scripts.prepublish="npm run build"),e.scripts.build||(e.scripts.build="module-packer build"),e.scripts.serve||(e.scripts.serve="module-packer serve"),e.scripts.watch||(e.scripts.watch="module-packer watch"),(0,s.writeJSON)((0,s.workspacePath)("package.json"),e)})():(p(),(()=>{const e=(0,s.readJSON)((0,s.workspacePath)("package.json"));e.devDependencies={},(0,s.writeJSON)((0,s.workspacePath)("package.json"),e)})()))},init:()=>p(u,...d)})[m](g)},617:(e,o,r)=>{r.d(o,{copyResource:()=>h,executablePath:()=>w,isPackage:()=>v,packagePath:()=>k,readFile:()=>n,readJSON:()=>i,resourcePath:()=>y,workspaceDirectory:()=>u,workspacePath:()=>b,workspacePathExists:()=>f,writeFile:()=>t,writeJSON:()=>l});const s=require("fs"),a=require("path"),c="@oneisland/module-packer-dev",n=e=>(0,s.readFileSync)(e,{encoding:"utf-8"}),t=(e,o)=>(0,s.writeFileSync)(e,o),i=e=>JSON.parse(n(e)),l=(e,o)=>t(e,JSON.stringify(o,null,2)),p=(e,o)=>{if("/"==e)return"none";if((0,s.existsSync)((0,a.resolve)(e,"package.json"))){const{name:r}=i((0,a.resolve)(e,"package.json"));if(o&&o(r))return e}else if((0,s.existsSync)((0,a.resolve)(e,"node_modules")))return e;return p((0,a.resolve)(e,"../"),o||null)},u=p(process.cwd(),(e=>e!=c)).replace(/node_modules.*/,""),d=p(__dirname,(e=>e==c)),m=`${d.replace(/node_modules.*/,"")}/node_modules`,g=`${d}/resources`,k=e=>`${d}/${e}`,b=e=>`${u}/${e}`,w=e=>`${m}/.bin/${e}`,y=e=>`${g}/${e}`,f=e=>(0,s.existsSync)(b(e)),v="none"==u,h=(e,o)=>{var r;r=e,(0,s.existsSync)(y(r))&&!f(o)&&(0,s.copyFileSync)(y(e),b(o))}}},o={};function r(s){if(o[s])return o[s].exports;var a=o[s]={exports:{}};return e[s](a,a.exports,r),a.exports}return r.n=e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return r.d(o,{a:o}),o},r.d=(e,o)=>{for(var s in o)r.o(o,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:o[s]})},r.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(105)})()}));
//# sourceMappingURL=cli.js.map